<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<link rel="stylesheet" href="/stylesheets/style.css" />
	</head>
	<body>
		<%- include('partials/header.ejs') %>
		<main>
			<div class="detailmovie-container">
				<div class="movie_poster">
					<img
						class="movie-img"
						src="/images/<%= movie.img %>"
						alt=""
					/>
				</div>
				<div class="movie_info">
					<div class="movie-header">
						<p class="title"><%= movie.title %></p>
						<p class="creator">ðŸ–‹<%= movie.creator.name %></p>
					</div>
					<div>
						<!-- Rating -->
						<% for(let i=0; i< movie.rating; i++ ) { %>
						<p class="rating">
							<img src="/images/star-60.png" alt="" />
						</p>
						<% }%>
						<!-- Release Date -->
						<p class="release-date"><%= movie.releaseDate %></p>

						<h3>The Synopsis</h3>
						<p class="synopsis"><%= movie.synopsis %></p>

						<!-- Genre -->
						<p class="sub_title">Genre:</p>
						<% movie.genre.forEach( eachGenre => { %>
						<span class="eachCast">â¦¿ <%= eachGenre %></span>
						<% }) %>
						<!-- Casts -->
						<p class="sub_title">Casts:</p>
						<% movie.casts.forEach( eachCast => { %>
						<span class="eachCast">â¦¿ <%= eachCast %> </span>
						<% }) %>
						<br />
					</div>

					<% if(currentUser.name === movie.creator.name ) { %>
					<div class="button_contianer">
						<a href="/movies/editMovie/<%= movie.id %>"
							><button>Edit</button></a
						>
						<a href="/movies/delete/<%= movie.id %>"
							><button>Delete</button></a
						>
					</div>
					<% } %>

					<div class="comment_container">
						<form
							action="/movies/comments/<%= movie._id %>"
							method="POST"
						>
							<input
								type="text"
								name="text"
								placeholder="Add your review here..."
							/>
							<input
								class="submit_button"
								type="submit"
								value="Add Comment"
							/>
						</form>

						<% movie.comments.forEach( comment => {%>
						<div>
							<span class="comment-author"
								><%= comment.author.name %></span
							>
							<span class="comment-text">
								<%= comment.text %></span
							>
						</div>

						<%})%>
					</div>
				</div>
			</div>
		</main>
	</body>
</html>
